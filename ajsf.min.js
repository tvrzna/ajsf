/**
	ajsf 0.0.1

	https://github.com/tvrzna/ajsf
**/
Ajsf={init:function(e,t){t.find("[ajsf-bind]").each(function(a,r){var i=$(r),n=i.attr("ajsf-bind");if(void 0===Ajsf.digObject(e,n)&&Ajsf.digObject(e,n,""),"INPUT"===i.prop("tagName")||"TEXTAREA"===i.prop("tagName")){var s;if("TEXTAREA"===i.prop("tagName"))s="input";else switch(i.prop("type")){case"text":case"password":case"email":case"url":case"search":case"number":s="input";break;case"submit":break;default:s="change"}void 0!==s&&i.on(s,function(){Ajsf.digObject(e,n,Ajsf.getVal(r)),Ajsf.refresh(e,t,n)})}}),t.find("[ajsf-click]").each(function(t,a){var r=$(a),i=r.attr("ajsf-click");r.on("click",function(t){Ajsf.digObject(e,i)(t,a)})}),t.find("[ajsf-keyup]").each(function(t,a){var r=$(a),i=r.attr("ajsf-keyup");r.on("keyup",function(t){Ajsf.digObject(e,i)(t,a)})}),t.find("[ajsf-change]").each(function(t,a){var r=$(a),i=r.attr("ajsf-change");r.on("change",function(t){Ajsf.digObject(e,i)(t,a)})}),Ajsf.refresh(e,t)},digObject:function(e,t,a){var r=t.split("|"),i=r[0].trim(),n=!1;i.startsWith("!")&&(i=r[0].substring(1).trim(),n=!0);for(var s,f=/(.*?)\[([0-9]+)\]/g,c=i.split("."),o=0,p=e.context;o<c.length-1;o++){var d;null!==(d=f.exec(c[o]))&&void 0!==p[d[1]][d[2]]?p=p[d[1]][d[2]]:void 0!==p[c[o]]&&(p=p[c[o]])}if(null!==(d=f.exec(c[o]))){if(void 0!==a)return void(p[d[1]][d[2]]=a);s=p[d[1]][d[2]]}else{if(void 0!==a)return void(p[c[o]]=a);s=p[c[o]]}n&&(s=!s);for(var l=1;l<r.length;l++)null!=r[l]&&(s=Ajsf.filter(e,r[l].trim(),s));return s},filter:function(e,t,a){if(null==a)return a;var r,i;switch(r=(t=t.replace(/\s\s+/g," ")).split(" ")[0],t.indexOf(" ")>0&&void 0!==(i=t.substring(t.indexOf(" ")).trim())&&(i=i.startsWith("'")&&i.endsWith("'")||i.startsWith('"')&&i.endsWith('"')?i.substring(1,i.length-1):isNaN(i)?Ajsf.digObject(e,i):Number(i)),r.toLowerCase()){case"gt":return a>i;case"gte":return a>=i;case"lt":return a<i;case"lte":return a<=i;case"eq":return a==i;case"ne":return a!=i;case"limit":return a.slice(0,Number(i));default:return console.warn("Filter "+r+" is not implemented yet."),a}},refresh:function(app,el,attr){var prefix=":not([ajsf-repeated]) > ";el.is("[ajsf-repeated]")&&(prefix="");var suffix="";for(var name in void 0!==attr&&void 0!==Ajsf.digObject(app,attr)&&(suffix='="'+attr+'"'),el.find(prefix+"[ajsf-bind"+suffix+"]").each(function(e,t){""===suffix&&(attr=$(t).attr("ajsf-bind")),Ajsf.setVal(t,Ajsf.digObject(app,attr))}),el.find(prefix+"[ajsf-hide"+suffix+"]").each(function(e,t){var a=$(t);""===suffix&&(attr=a.attr("ajsf-hide")),Ajsf.digObject(app,attr)?a.hide():a.show()}),el.find(prefix+"[ajsf-show"+suffix+"]").each(function(e,t){var a=$(t);""===suffix&&(attr=a.attr("ajsf-show")),Ajsf.digObject(app,attr)?a.show():a.hide()}),el.find(prefix+"[ajsf-class]").each(function(i,e){var $e=$(e);for(var key in attr=JSON.parse(JSON.stringify(eval("("+$e.attr("ajsf-class")+")"))),attr){var value=Ajsf.digObject(app,key);value?$e.hasClass(attr[key])||$e.addClass(attr[key]):$e.removeClass(attr[key])}}),el.find(prefix+"[ajsf-repeated"+suffix+"]").each(function(e,t){$(t).remove()}),el.find(prefix+"[ajsf-repeat"+suffix+"]").each(function(e,t){var a=$(t);a.hide(),""===suffix&&(attr=a.attr("ajsf-repeat"));var r=Ajsf.digObject(app,attr);if(void 0!==r)for(var i in r){var n=a.clone().removeAttr("ajsf-repeat").attr("ajsf-repeated","true").show().insertBefore(a),s={context:{parent:function(){return app.context},item:r[i]},directives:app.directives};s.context.item.index=i,Ajsf.init(s,n)}}),app.directives){var directive=app.directives[name],applyDirective=function(e){var t=$(e),a=t.attr("ajsf-model"),r=void 0;if(null!==a)r=Ajsf.digObject(app,a);t.html(directive.template);var i={context:{model:r,parent:function(){return app.context},refresh:function(e){e||"function"!=typeof i.context.onRefresh||i.context.onRefresh(),Ajsf.refresh(i,t)}},directives:app.directives};void 0!==directive.definition&&(i.context=Object.assign(i.context,directive.definition(i.context,e))),Ajsf.init(i,t)};el.prop("tagName")===name.toUpperCase()||null!==el.attr("ajsf-repeat")||null!==el.attr("ajsf-repeated")?""===el.html()&&applyDirective(el[0]):el.find(name).each(function(e,t){var a=$(t);""===a.html()&&null===a.attr("ajsf-repeat")&&null===a.attr("ajsf-repeated")&&applyDirective(t)})}},getVal:function(e){var t=$(e);switch(t.prop("type")){case"checkbox":return t.prop("checked");case"radio":for(var a=t.attr("ajsf-bind"),r=$("input[ajsf-bind="+a+"][type=radio]"),i=0;i<=r.length;i++)if((t=$(r[i])).prop("checked"))return t.val();return null;default:return t.val()}},setVal:function(e,t){var a=$(e);if("INPUT"===a.prop("tagName"))switch(a.prop("type")){case"checkbox":a.prop("checked",t);break;case"radio":a.prop("checked",e.value==t);break;default:a.val(t)}else"SPAN"===a.prop("tagName")||"DIV"===a.prop("tagName")||"P"===a.prop("tagName")||"BUTTON"===a.prop("tagName")?a.text(t):console.warn("Report element "+a.prop("tagName")+" was missed, please.")}},window.ajsf=function(e,t){var a=$('[ajsf="'+e+'"]'),r={context:{},directives:{},directive:function(e,t,a){this.directives[e]={template:t,definition:a}}};return r.context.refresh=function(){Ajsf.refresh(r,a)},r.context=Object.assign(r.context,t(r.context)),$(document).ready(function(){Ajsf.init(r,a)}),r};
